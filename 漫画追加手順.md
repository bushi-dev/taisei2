# 漫画追加手順

このドキュメントでは、武将の生涯を描く10コマのカラー漫画を自動生成し、プロジェクトに追加する手順を説明します。

---

## 概要

Manus AI（または他の画像生成AI）を使って、`public/json/warlords/{id}.json` の biography データから10コマの歴史学習漫画を生成します。

---

## ⚠️ スキップルール（重要）

**すでに漫画が存在する武将はスキップしてください。**

### 判定方法

1. `public/image/manga/` フォルダ内のファイル一覧を確認
2. 武将の `image` フィールドからファイル名を抽出（例: `oda_nobunaga.png` → `nobunaga`）
3. `public/image/manga/{ファイル名}.png` が存在する場合 → **スキップ**
4. 存在しない場合 → 漫画を生成

### 例

```
public/image/manga/ に nobunaga.png が存在する場合：
  → 織田信長（ID: 1）の漫画生成はスキップ

public/image/manga/ に hideyoshi.png が存在しない場合：
  → 豊臣秀吉（ID: 14）の漫画を生成する
```

---

## Manus での指示方法（クイックスタート）

### 方法1: チャットでファイルを添付して指示

Manus のチャット画面で、以下のファイルを添付してから指示を送信してください：

**添付するファイル:**

- `漫画追加手順.md`（このファイル）
- `public/json/warlords/index.json`
- `public/json/warlords/{対象武将のID}.json`

**送信する指示:**

```
添付したファイルを参照して、豊臣秀吉の10コマ漫画を生成してください。
漫画追加手順.mdのプロンプトに従って作成し、public/image/manga/hideyoshi.png として保存してください。
すでに存在する場合はスキップしてください。
```

### 方法2: プロジェクト全体を読み込ませて指示

Manus にプロジェクトフォルダを読み込ませている場合：

```
@漫画追加手順.md @public/json/warlords/index.json @public/json/warlords/14.json

このファイルを参照して、豊臣秀吉の10コマ漫画を生成してください。
すでに public/image/manga/ に存在する場合はスキップしてください。
```

### 方法3: 全武将の漫画を一括生成

```
@漫画追加手順.md @public/json/warlords/ @public/image/manga/

漫画追加手順.mdに従って、全武将の10コマ漫画を生成してください。
public/image/manga/ にすでに存在する武将はスキップしてください。
未作成の武将のみ生成して、public/image/manga/{ローマ字名}.png として保存してください。
```

---

## ファイル構成

| ファイルパス                      | 説明                                           |
| --------------------------------- | ---------------------------------------------- |
| `public/json/warlords/index.json` | 全武将の一覧（ID、名前、読み方、画像パスなど） |
| `public/json/warlords/{id}.json`  | 各武将の詳細データ（biography、quiz）          |
| `public/image/manga/`             | 生成した漫画画像の保存先                       |

---

## ステップ1: 武将データの確認

### 1-1. 武将一覧を確認

```
public/json/warlords/index.json
```

このファイルを読み込んで、対象武将の `id` と `name` を確認してください。

### 1-2. 武将の詳細データを確認

```
public/json/warlords/{id}.json
```

対象武将のIDを使って、詳細データ（biography）を取得してください。

---

## ステップ2: Manus AI への依頼

以下のプロンプトテンプレートを使用してください。

---

### 漫画生成プロンプト

```markdown
以下のJSONデータを使って、この武将の生涯を描く10コマのカラー漫画を作成してください。

# 指示事項

1. **ターゲット読者とスタイル:**
   - 小学生向けの歴史学習漫画を想定してください。
   - 親しみやすく、ダイナミックで分かりやすいカラーの画風でお願いします。
   - **重要：** 全ての漢字に、小学生が読めるようにふりがな（ルビ）を振ってください。

2. **構成とレイアウト:**
   - 全10コマを「2行 × 5列」のレイアウトで配置してください。
   - 左上から右下へ向かって時系列が進むようにしてください。
   - 1枚の画像として出力してください（横長のパノラマ形式）。

3. **内容とキャラクターの成長:**
   - JSONデータの `biography` のstage 1から10を、順に1コマずつ割り当ててください。
   - 武将の成長に合わせて、容姿や服装を変化させてください（幼少期→青年期→壮年期）。
   - **補足情報:** stage 1の幼少期は幼名で呼ばれていました。1コマ目では周囲の人物がその幼名で呼ぶなどして、それを表現してください。

4. **各コマの要素:**
   - **上部枠:** JSONの `year`（年号）と `title`（タイトル）を目立つ枠に入れて表示してください。
   - **イラスト:** その `description` の出来事を象徴する、動きのあるシーンを描いてください。
   - **セリフ:** 状況を端的に表す短いセリフを吹き出しに入れてください。難しい言葉は避け、やさしい言葉遣いにしてください。

5. **画像サイズ:**
   - 横幅: 2000px 以上を推奨
   - 縦幅: 800px 程度を推奨
   - 解像度: 高解像度（印刷にも対応可能なレベル）

# 武将の幼名について

武将の幼名が不明な場合は、Webで検索して調べてください。
代表的な武将の幼名は以下のとおりです：

- 織田信長 → 吉法師（きっぽうし）
- 豊臣秀吉 → 日吉丸（ひよしまる）
- 徳川家康 → 竹千代（たけちよ）
- 武田信玄 → 勝千代（かつちよ）

# JSONデータ

（ここに武将のJSONデータが入ります）
```

---

## ステップ3: Manus AI を使った自動化手順

Manus AI のファイル操作機能を使って、漫画追加を自動化できます。

### 3-1. 単体の武将の漫画を生成

以下のプロンプトをManus AIに送信してください：

```markdown
# 漫画自動追加タスク

## 参照ファイル

- 手順書: @漫画追加手順.md
- 武将一覧: @public/json/warlords/index.json
- 既存の漫画: @public/image/manga/

## スキップ判定

1. `public/image/manga/` フォルダ内のファイル一覧を確認
2. 対象武将の漫画ファイルがすでに存在する場合 → **スキップして終了**
3. 存在しない場合 → 以下の分析・生成タスクを実行

## 分析タスク

1. `public/json/warlords/index.json` を読み込み、武将名「【ここに武将名を入力】」のIDを特定する
2. 特定したIDを使って `public/json/warlords/{id}.json` を読み込む
3. index.json の `image` フィールドからローマ字名を抽出する
   - 例: `/image/busho/oda_nobunaga.png` → `nobunaga`
   - ルール: 最後の `_` 以降の部分（拡張子を除く）をファイル名として使用

## 生成タスク

4. 「漫画追加手順.md」の漫画生成プロンプトに、取得したJSONデータを埋め込む
5. 10コマの漫画画像を生成する
6. 生成した画像を `public/image/manga/{ローマ字名}.png` として保存する

## 対象武将

【ここに武将名を入力】
```

### 3-2. 一括生成の指示

複数の武将の漫画を一括生成する場合：

```markdown
# 漫画一括生成タスク

## 参照ファイル

- 手順書: @漫画追加手順.md
- 武将一覧: @public/json/warlords/index.json
- 武将詳細: @public/json/warlords/（各IDのJSONファイル）
- 既存の漫画: @public/image/manga/

## ⚠️ スキップルール（必須）

**すでに漫画が存在する武将は必ずスキップすること！**

1. `public/image/manga/` フォルダ内の既存ファイル一覧を取得
2. 各武将について、対応する漫画ファイルが存在するかチェック
3. 存在する → スキップ、存在しない → 生成対象

## 分析タスク

1. `public/json/warlords/index.json` を読み込み、全武将のリストを取得
2. `public/image/manga/` フォルダ内の既存ファイルを確認
3. 漫画が未作成の武将のみをリストアップ（**作成済みはスキップ**）

## ファイル名の抽出ルール

index.json の各武将の `image` フィールドからローマ字名を抽出：

- `image` の値（例: `/image/busho/oda_nobunaga.png`）から
- 最後の `_` 以降の部分を取得し、拡張子を除去
- 例: `oda_nobunaga.png` → `nobunaga`

## 生成タスク

**漫画が未作成の武将のみ**について：

1. `public/json/warlords/{id}.json` を読み込む
2. 「漫画追加手順.md」の漫画生成プロンプトにデータを埋め込む
3. 10コマの漫画画像を生成
4. `public/image/manga/{ローマ字名}.png` として保存

## 進捗レポート

処理完了後、以下の形式でレポートを出力：

| 種別     | 内容                                 |
| -------- | ------------------------------------ |
| スキップ | すでに漫画が存在した武将名の一覧     |
| 生成完了 | 今回生成した武将名とファイル名の一覧 |
| 生成数   | 今回生成した漫画の数                 |
```

### 3-3. 特定IDの武将の漫画を生成

IDを直接指定する場合：

```markdown
# 漫画生成タスク（ID指定）

## 参照ファイル

- 手順書: @漫画追加手順.md
- 武将一覧: @public/json/warlords/index.json
- 既存の漫画: @public/image/manga/

## スキップ判定

1. `public/image/manga/` フォルダを確認
2. 対象武将の漫画がすでに存在する場合 → **スキップして終了**

## タスク

1. `public/json/warlords/index.json` から武将ID【ここにIDを入力】の情報を取得
2. `public/json/warlords/{id}.json` を読み込む
3. `image` フィールドからファイル名を抽出
4. **漫画が存在しない場合のみ**、生成して `public/image/manga/{抽出したファイル名}.png` に保存

## 対象武将ID

【ここにIDを入力】
```

---

## ステップ4: 画像の保存ルール

### 4-1. ファイル名の命名規則

**index.json の `image` フィールドから抽出:**

```
image: "/image/busho/xxx_yyy.png"
                      ↓
         ファイル名: yyy.png
```

**抽出ルール:**

1. `image` パスの最後のファイル名部分を取得
2. `_` で分割し、最後の要素を取得
3. 拡張子を `.png` にする

**例:**

- `/image/busho/oda_nobunaga.png` → `nobunaga.png`
- `/image/busho/toyotomi_hideyoshi.png` → `hideyoshi.png`
- `/image/busho/tokugawa_ieyasu.png` → `ieyasu.png`

### 4-2. 保存先

```
public/image/manga/{ファイル名}.png
```

---

## ステップ5: 品質チェックリスト

生成された漫画が以下の基準を満たしているか確認してください：

- [ ] 10コマすべてが含まれている
- [ ] 各コマに年号とタイトルが表示されている
- [ ] すべての漢字にふりがなが振られている
- [ ] 武将の成長（幼少期→青年期→壮年期）が描かれている
- [ ] stage 1で幼名が使われている
- [ ] セリフが小学生でも理解できる言葉遣いになっている
- [ ] レイアウトが「2行 × 5列」になっている
- [ ] 画像の解像度が十分（横幅2000px以上）

---

## トラブルシューティング

### Q: 生成された画像の解像度が低い場合

プロンプトに以下を追加してください：

```
# 追加指示
- 出力解像度: 4000px × 1600px
- 形式: PNG（高画質）
- 圧縮: なし
```

### Q: ふりがなが表示されない場合

プロンプトを修正して強調してください：

```
**重要（必須）:**
すべての漢字に必ずふりがな（ルビ）を振ってください。
ふりがながない漫画は使用できません。
```

### Q: コマのレイアウトが崩れる場合

以下の詳細レイアウト指示を追加：

```
# レイアウト詳細
- 1行目: stage 1〜5（左から右へ）
- 2行目: stage 6〜10（左から右へ）
- 各コマのサイズ: 400px × 400px（目安）
- コマ間のスペース: 10px
- 全体の背景: 和紙風のテクスチャ
```

---

## 既存漫画の確認方法

既存の漫画ファイルを確認するには：

```markdown
# 既存漫画の確認

## 参照ファイル

- @public/image/manga/

## タスク

1. `public/image/manga/` フォルダ内のファイル一覧を取得
2. 各ファイル名から武将を特定（index.json の image フィールドと照合）
3. 漫画作成済みの武将リストを出力
```

---

## 武将情報の参照方法

武将のIDや名前を確認するには：

```markdown
# 武将情報の確認

## 参照ファイル

- @public/json/warlords/index.json

## タスク

index.json を分析して、以下の情報を一覧表示：

- ID
- 武将名（name）
- 読み方（reading）
- 漫画ファイル名（image から抽出）

## 出力形式

| ID | 武将名 | 読み方 | 漫画ファイル名 |
```

---

## データ構造リファレンス

### index.json の構造

```json
[
  {
    "id": 数値,
    "name": "武将名",
    "reading": "よみがな",
    "image": "/image/busho/{prefix}_{name}.png",
    "relatedPrefectures": ["都道府県"],
    "birthYears": [生年],
    "deathYears": [没年],
    "hideyoshiBrothersFlag": boolean,
    "concertFlag": boolean
  }
]
```

### {id}.json の構造

```json
{
  "id": 数値,
  "biography": [
    {
      "stage": 1〜10,
      "year": "年号",
      "title": "タイトル",
      "description": "説明文"
    }
  ],
  "quiz": [
    {
      "question": "問題文",
      "options": ["選択肢1", "選択肢2", "選択肢3"],
      "correctAnswer": 0〜2,
      "explanation": "解説"
    }
  ]
}
```
